---
title: "Palmer Penguins"
subtitle: "TidyTuesday 2020, Week 31"
author: "Botan Ağın"
date: "11/30/2020"
output: html_document
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(tidyverse)
library(palmerpenguins)
library(ggridges)
library(showtext)
library(magick)
library(here)
```

```{r fonts}
font_add_google("Righteous")
font_add_google("IBM Plex Sans")
showtext_auto()
```

```{r wrangle}
penguins_long <- penguins %>% 
  pivot_longer(
    bill_length_mm:body_mass_g, 
    names_to = "attribute", 
    values_to = "value"
  ) %>% 
  mutate(
    attribute = attribute %>% 
      str_replace_all("_", " ") %>% 
      str_to_title() %>% 
      str_replace("Mm$", "(mm)") %>% 
      str_replace("G$", "(g)"),
    sex = str_to_title(sex)
  ) %>% 
  mutate_if(is.character, as.factor) %>% 
  drop_na()
```

```{r images}
pengs <- image_read(here("images", "penguin-species.png"))
bill <- image_read(here("images", "culmen-depth.png"))
```

```{r plot}
pdf(here("plots", "2020-w31-palmerpenguins.pdf"), width = 6, height = 9)

penguins_long %>% 
  ggplot(aes(value, species, fill = species, color = species)) +
  geom_density_ridges(alpha = 0.75) + 
  labs(
    title = "\n \n Palmer Penguins",
    subtitle = "Distrubutions of Attributes by Species \n \n",
    caption = "\n \n \n \n
      Data: github.com/allisonhorst/palmerpenguins
      Source: Gorman, Williams & Fraser (2014)
      Artwork by @allison_horst
      Visualization by @botanagin"
  ) + 
  theme_minimal() + 
  theme(
    axis.title = element_blank(),
    axis.text = element_text(size = 10),
    axis.text.y = element_blank(),
    strip.text = element_text(family = "IBM Plex Sans", 
                              size = 11),
    legend.position = "none",
    plot.title = element_text(hjust = 0.1,
                              family = "Righteous",
                              face = "bold",
                              size = 16),
    plot.subtitle = element_text(hjust = 0.1, 
                                 family = "Righteous",
                                 face = "bold",
                                 color = "gray70",
                                 size = 14),
    plot.caption = element_text(hjust = 1, 
                                family = "IBM Plex Sans"),
    plot.margin = margin(15, 15, 15, 15, unit = "pt")
  ) +
  scale_fill_manual(values = c("darkorange", "darkorchid", "darkcyan")) + 
  scale_color_manual(values = c("darkorange", "darkorchid", "darkcyan")) +
  facet_wrap(~ attribute, scales = "free", ncol = 1)
grid::grid.raster(pengs, width = 0.3, height = 0.15, x = 0.8, y = 0.9)
grid::grid.raster(bill, width = 0.3, height = 0.15, x = 0.2, y = 0.1)

dev.off()
```

